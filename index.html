<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">SPMB Online - KB Harapan Bunda</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- TEMA WARNA & RESET --- */
        :root {
            --primary: #FFD166;    /* Kuning Cerah */
            --secondary: #118AB2;  /* Biru Laut */
            --accent: #EF476F;     /* Pink Kemerahan */
            --dark: #073B4C;       /* Biru Gelap */
            --paper: #FFFFFF;
            --bg: #F0F2F5;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 20px 10px;
        }

        /* --- KONTAINER KERTAS A4 --- */
        .a4-wrapper {
            background: var(--paper);
            width: 100%;
            max-width: 800px; /* Ukuran mendekati A4 */
            min-height: 100vh;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER --- */
        header {
            background: linear-gradient(135deg, var(--primary), #FFC107);
            padding: 40px 30px;
            text-align: center;
            border-bottom: 6px solid var(--accent);
            position: relative;
        }
        
        /* Hiasan Bulat di Header */
        .circle-decor { position: absolute; background: rgba(255,255,255,0.25); border-radius: 50%; }
        .c1 { width: 120px; height: 120px; top: -30px; left: -30px; }
        .c2 { width: 80px; height: 80px; bottom: 10px; right: 20px; }

        header h2 { font-family: 'Fredoka', sans-serif; color: var(--secondary); font-size: 1.4rem; letter-spacing: 1px; margin-bottom: 5px; position: relative; }
        header h1 { font-family: 'Fredoka', sans-serif; color: var(--dark); font-size: 2.5rem; text-transform: uppercase; margin-bottom: 10px; position: relative; line-height: 1.2; }
        header h3 { font-family: 'Fredoka', sans-serif; color: var(--secondary); font-size: 1.4rem; letter-spacing: 1px; margin-bottom: 5px; margin-top: 5px;position: relative;}
        .badge { background: var(--accent); color: white; padding: 5px 20px; border-radius: 20px; font-weight: bold; font-size: 0.9rem; display: inline-block; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: relative; }

        /* --- KONTEN UTAMA --- */
        .content { padding: 40px 30px; flex: 1; }

        .welcome-text { text-align: center; margin-bottom: 40px; }
        .welcome-text h3 { color: var(--secondary); font-family: 'Fredoka', sans-serif; font-size: 1.8rem; margin-bottom: 10px; }
        .welcome-text p { color: #555; line-height: 1.6; }

        /* --- INFO GRID --- */
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .info-card { 
            background: #F8FDFF; border: 2px solid #E0F7FA; 
            padding: 20px; border-radius: 15px; 
            border-left: 5px solid var(--secondary);
            transition: 0.3s;
        }
        .info-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .info-card h4 { color: var(--secondary); font-size: 0.9rem; margin-bottom: 8px; text-transform: uppercase; display: flex; align-items: center; gap: 8px; }
        .info-card p { font-weight: 600; font-size: 1rem; color: #333; }
        .info-card small { font-weight: normal; color: #666; font-size: 0.85rem; }

        /* --- GALERI FOTO (LOKAL) --- */
        .gallery { text-align: center; margin-bottom: 40px; }
        .gallery h3 { font-family: 'Fredoka', sans-serif; color: var(--accent); font-size: 1.6rem; margin-bottom: 20px; }
        .gallery-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        
        .photo-frame { 
            aspect-ratio: 4/3; 
            background: #eee; 
            border-radius: 12px; 
            overflow: hidden; 
            border: 4px solid white; 
            box-shadow: 0 3px 8px rgba(0,0,0,0.1); 
            position: relative;
        }
        .photo-frame img { 
            width: 100%; height: 100%; object-fit: cover; 
            transition: 0.4s; 
        }
        .photo-frame:hover img { transform: scale(1.1); }

        /* --- TOMBOL CTA --- */
        .cta-container { text-align: center; margin-top: 20px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
        
        .btn-daftar {
            background: var(--secondary); color: white;
            padding: 15px 50px; border-radius: 50px;
            font-size: 1.2rem; font-weight: bold; border: none;
            cursor: pointer; text-decoration: none;
            box-shadow: 0 4px 15px rgba(17, 138, 178, 0.4);
            transition: 0.3s; display: inline-flex; align-items: center; gap: 10px;
        }
        .btn-daftar:hover { background: #0c6ba1; transform: scale(1.02); }

        .btn-wa {
            color: #25D366; background: white;
            border: 2px solid #25D366;
            padding: 10px 25px; border-radius: 50px;
            font-weight: 600; text-decoration: none;
            transition: 0.3s; display: inline-flex; align-items: center; gap: 8px;
        }
        .btn-wa:hover { background: #25D366; color: white; }

        /* --- FORMULIR --- */
        #view-form { display: none; animation: fadeIn 0.5s; }
        .form-header { text-align: center; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--dark); }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 8px;
            font-family: inherit; transition: 0.3s;
        }
        .form-group input:focus, .form-group textarea:focus { border-color: var(--secondary); outline: none; }
        
        .divider { border-top: 2px dashed #ddd; margin: 30px 0; position: relative; }
        .divider span { position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: white; padding: 0 10px; color: #aaa; font-size: 0.8rem; font-weight: bold; letter-spacing: 1px; }

        .btn-back { background: none; border: none; color: #777; cursor: pointer; display: flex; align-items: center; gap: 5px; margin-bottom: 20px; font-weight: 500; }
        .btn-back:hover { color: var(--dark); }

        /* LOADING */
        .loading { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(255,255,255,0.9); z-index: 999; justify-content: center; align-items: center; flex-direction: column; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--secondary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Responsive */
        @media (max-width: 600px) {
            body { padding: 0; background: white; }
            .a4-wrapper { box-shadow: none; max-width: 100%; }
            header h1 { font-size: 2rem; }
            .gallery-grid { grid-template-columns: 1fr; } 
            /* Di HP foto jadi 1 kolom biar besar */
        }
    </style>
</head>
<body>

    <div class="a4-wrapper">
        <header>
            <div class="circle-decor c1"></div>
            <div class="circle-decor c2"></div>
            
            <h2 id="sub-judul">Sistem Penerimaan Murid Baru</h2>
            <h1 id="judul-utama">KB HARAPAN BUNDA</h1>
            <div class="badge" id="tahun-ajaran">Tahun Ajaran 2026/2027</div>
            <h3 id="slogan">Membentuk Generasi Cerdas, Ceria Dan Berakhlak Mulia</h3>
        </header>

        <div id="view-brochure" class="content">
            <div class="welcome-text">
                <h3 id="hero-title">Selamat Datang Ayah & Bunda!</h3>
                <p id="hero-desc">Mari bergabung bersama keluarga besar kami. Membentuk generasi cerdas, ceria, dan berakhlak mulia dalam lingkungan yang aman dan menyenangkan.</p>
            </div>

            <div class="info-grid">
                <div class="info-card">
                    <h4><i class="fas fa-calendar-check"></i> Waktu Pendaftaran</h4>
                    <p id="periode-daftar">Januari 2026</p>
                    <small>Gelombang 1</small>
                </div>
                <div class="info-card">
                    <h4><i class="fas fa-map-marker-alt"></i> Lokasi Sekolah</h4>
                    <p id="alamat-sekolah">Wisma Harapan Blok D01/13, Gembor - Tangerang</p>
                </div>
                <div class="info-card">
                    <h4><i class="fas fa-phone"></i> Hubungi Kami</h4>
                    <p id="kontak-person">Ibu Rosmalawati</p>
                    <small id="no-kontak">0813-9880-2930</small>
                </div>
            </div>

            <div class="gallery">
                <h3 id="judul-galeri">Galeri Kegiatan</h3>
                <div class="gallery-grid">
                    <div class="photo-frame">
                        <img id="img-1" src="img/foto1.jpg" alt="Kegiatan 1" onerror="this.src='https://via.placeholder.com/300x200?text=Foto+1'">
                    </div>
                    <div class="photo-frame">
                        <img id="img-2" src="img/foto2.jpg" alt="Kegiatan 2" onerror="this.src='https://via.placeholder.com/300x200?text=Foto+2'">
                    </div>
                    <div class="photo-frame">
                        <img id="img-3" src="img/foto3.jpg" alt="Kegiatan 3" onerror="this.src='https://via.placeholder.com/300x200?text=Foto+3'">
                    </div>
                </div>
            </div>

            <div class="cta-container">
                <button onclick="bukaFormulir()" class="btn-daftar">
                    <i class="fas fa-pen-fancy"></i> Isi Formulir Pendaftaran
                </button>
                <a href="https://wa.me/6281398802930" target="_blank" class="btn-wa" id="link-wa">
                    <i class="fab fa-whatsapp"></i> Tanya via WhatsApp
                </a>
            </div>
            
            <div style="text-align: center; margin-top: 40px; color: #999; font-size: 0.8rem;">
                &copy; 2026 KB Harapan Bunda. Pendidikan Anak Usia Dini.
            </div>
        </div>

        <div id="view-form" class="content">
            <button onclick="tutupFormulir()" class="btn-back"><i class="fas fa-arrow-left"></i> Kembali</button>
            
            <div class="form-header">
                <h3 style="color: var(--secondary); font-family: 'Fredoka', sans-serif;">Formulir Pendaftaran</h3>
                <p>Mohon isi data calon siswa dengan lengkap.</p>
            </div>

            <form id="formPendaftaran">
                <input type="hidden" name="action" value="simpan_pendaftaran">

                <div class="form-group">
                    <label>Nama Lengkap Anak</label>
                    <input type="text" name="nama" required placeholder="Sesuai Akta Kelahiran">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>Tanggal Lahir</label>
                        <input type="date" name="tgl_lahir" required>
                    </div>
                    <div class="form-group">
                        <label>Jenis Kelamin</label>
                        <select name="jk" required>
                            <option value="">- Pilih -</option>
                            <option value="Laki-laki">Laki-laki</option>
                            <option value="Perempuan">Perempuan</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Agama</label>
                    <select name="agama" required>
                        <option value="Islam">Islam</option>
                        <option value="Kristen">Kristen</option>
                        <option value="Katolik">Katolik</option>
                        <option value="Hindu">Hindu</option>
                        <option value="Buddha">Buddha</option>
                    </select>
                </div>

                <div class="divider"><span>DATA ORANG TUA</span></div>

                <div class="form-group">
                    <label>Nama Ayah</label>
                    <input type="text" name="nama_ayah" required>
                </div>
                <div class="form-group">
                    <label>Pekerjaan Ayah</label>
                    <input type="text" name="pek_ayah" required>
                </div>

                <div class="form-group">
                    <label>Nama Ibu</label>
                    <input type="text" name="nama_ibu" required>
                </div>
                <div class="form-group">
                    <label>Pekerjaan Ibu</label>
                    <input type="text" name="pek_ibu" required>
                </div>

                <div class="form-group">
                    <label>No. HP Ibu (WhatsApp)</label>
                    <input type="tel" name="hp_ibu" required placeholder="Contoh: 08123456789">
                    <small style="color: #666; font-size: 0.8rem;">*Wajib nomor yang aktif WA</small>
                </div>

                <div class="form-group">
                    <label>Alamat Domisili</label>
                    <textarea name="alamat" rows="3" required placeholder="Jalan, RT/RW, Kelurahan..."></textarea>
                </div>

                <button type="submit" class="btn-daftar" style="width: 100%; justify-content: center; margin-top: 10px;">
                    Kirim Pendaftaran <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </div>
    </div>

    <div class="loading" id="loadingOverlay">
        <div class="spinner"></div>
        <h3 style="margin-top: 20px; color: var(--secondary);">Sedang Mengirim...</h3>
        <p>Mohon jangan tutup halaman ini.</p>
    </div>

    <script>
        // URL WEB APP ANDA (Sesuai Code.gs yang Anda berikan di awal)
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxObNo1BFGjWUnRnni96YUhjOGipY1lViTfVPfyRZDbhGbuPY6nDNrX2Nu89HxqmBzRhA/exec';

        // --- 1. NAVIGASI HALAMAN ---
        function bukaFormulir() {
            document.getElementById('view-brochure').style.display = 'none';
            document.getElementById('view-form').style.display = 'block';
            window.scrollTo(0,0);
        }

        function tutupFormulir() {
            document.getElementById('view-form').style.display = 'none';
            document.getElementById('view-brochure').style.display = 'block';
            window.scrollTo(0,0);
        }

        // --- 2. AMBIL DATA DARI ADMIN PANEL (Optional) ---
        // Jika admin panel diisi, teks akan berubah. Jika tidak, pakai default HTML di atas.
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Gunakan "get_admin_data" sesuai Code.gs Anda yang pertama
                const response = await fetch(scriptURL + '?action=get_admin_data');
                const data = await response.json();

                if (data.result === 'success' && data.konten) {
                    const c = data.konten;
                    
                    // Update Teks (Hanya jika diisi di Admin Panel)
                    if(c.judulUtama) document.getElementById('judul-utama').innerText = c.judulUtama;
                    if(c.subJudul) document.getElementById('sub-judul').innerText = c.subJudul;
                    if(c.slogan) document.getElementById('slogan').innerText = c.slogan;
                    if(c.tahunAjaran) document.getElementById('tahun-ajaran').innerText = c.tahunAjaran;
                    if(c.heroText) document.getElementById('hero-title').innerText = c.heroText;
                    if(c.alamatSekolah) document.getElementById('alamat-sekolah').innerText = c.alamatSekolah;
                    if(c.nomorKontak) {
                        document.getElementById('no-kontak').innerText = c.nomorKontak;
                        // Update link WA otomatis
                        let cleanNum = c.nomorKontak.replace(/\D/g, ''); // Hapus non-angka
                        if(cleanNum.startsWith('0')) cleanNum = '62' + cleanNum.slice(1);
                        document.getElementById('link-wa').href = `https://wa.me/${cleanNum}`;
                    }
                    
                    // CATATAN GAMBAR:
                    // Script ini TIDAK akan menimpa gambar jika di Admin Panel kosong.
                    // Jadi gambar tetap akan membaca dari folder "img/" di GitHub Anda.
                }
            } catch (e) {
                console.log("Mode Offline / Gagal fetch: Menggunakan konten default HTML.");
            }
        });

        // --- 3. KIRIM FORMULIR ---
        const form = document.getElementById('formPendaftaran');
        const loading = document.getElementById('loadingOverlay');

        form.addEventListener('submit', e => {
            e.preventDefault();
            if(!confirm("Pastikan data sudah benar. Lanjutkan kirim?")) return;

            loading.style.display = 'flex';
            
            // Gunakan mode 'no-cors' agar browser tidak memblokir POST request
            fetch(scriptURL, { method: 'POST', body: new FormData(form), mode: 'no-cors' })
            .then(() => {
                loading.style.display = 'none';
                alert("Alhamdulillah, Data Berhasil Terkirim!\nSilakan konfirmasi ke Ibu Guru via WA.");
                form.reset();
                tutupFormulir();
            })
            .catch(error => {
                loading.style.display = 'none';
                console.error('Error!', error.message);
                alert("Maaf, ada gangguan koneksi. Coba lagi atau hubungi WA langsung.");
            });
        });
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPDB Online - KB Harapan Bunda</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #118AB2; --secondary: #06D6A0; --dark: #073B4C; --light: #f4f7f6; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; scroll-behavior: smooth; }
        body { background: var(--light); color: #333; line-height: 1.6; }

        /* --- NAVBAR --- */
        nav { background: white; padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        .logo { font-weight: 700; font-size: 1.2rem; color: var(--primary); display: flex; align-items: center; gap: 10px; }
        .nav-links a { text-decoration: none; color: var(--dark); margin-left: 20px; font-weight: 500; transition: 0.3s; }
        .nav-links a:hover { color: var(--primary); }
        .btn-cta { background: var(--secondary); color: white; padding: 8px 20px; border-radius: 20px; text-decoration: none !important; }

        /* --- HERO SECTION (HALAMAN DEPAN) --- */
        .hero { 
            background: linear-gradient(135deg, var(--primary), var(--dark)); 
            color: white; padding: 80px 5% 100px; text-align: center; 
            border-radius: 0 0 50px 50px; margin-bottom: 40px;
        }
        .hero h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .hero p { font-size: 1.1rem; opacity: 0.9; margin-bottom: 30px; max-width: 600px; margin-left: auto; margin-right: auto; }
        .hero .btn-hero { background: white; color: var(--primary); padding: 12px 30px; border-radius: 30px; font-weight: bold; text-decoration: none; box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: 0.3s; }
        .hero .btn-hero:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.3); }

        /* --- CONTAINER FORMULIR --- */
        .container { max-width: 800px; margin: 0 auto 50px; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); position: relative; top: -50px; }
        
        .section-title { text-align: center; margin-bottom: 30px; }
        .section-title h2 { color: var(--primary); font-size: 1.8rem; }
        .section-title p { color: #666; font-size: 0.9rem; }

        /* --- FORM STYLING --- */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-full { grid-column: 1 / -1; }
        
        @media (max-width: 600px) { .form-grid { grid-template-columns: 1fr; } }

        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; color: var(--dark); }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 12px; border: 2px solid #eef2f5; border-radius: 8px; font-size: 0.95rem; transition: 0.3s;
        }
        .form-group input:focus, .form-group textarea:focus { border-color: var(--primary); outline: none; }
        
        .divider { grid-column: 1 / -1; border-top: 2px dashed #eee; margin: 10px 0 20px; position: relative; }
        .divider span { position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: white; padding: 0 15px; color: #aaa; font-size: 0.8rem; font-weight: bold; }

        .btn-submit {
            grid-column: 1 / -1; width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px;
        }
        .btn-submit:hover { background: #0c6ba1; }
        
        /* Loading Overlay */
        .loading-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(255,255,255,0.9); z-index: 9999; flex-direction: column; justify-content: center; align-items: center; }
        .spinner { width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        footer { text-align: center; padding: 30px; color: #888; font-size: 0.9rem; }
    </style>
</head>
<body>

    <nav>
        <div class="logo"><i class="fas fa-graduation-cap"></i> <span id="nav-title">PPDB Online</span></div>
        <div class="nav-links">
            <a href="#home">Beranda</a>
            <a href="#form-daftar" class="btn-cta">Daftar Sekarang</a>
        </div>
    </nav>

    <header class="hero" id="home">
        <h1 id="hero-title">Selamat Datang</h1>
        <p id="hero-desc">Mari bergabung bersama kami mewujudkan generasi cerdas, ceria, dan berakhlak mulia.</p>
        <a href="#form-daftar" class="btn-hero">Isi Formulir Pendaftaran <i class="fas fa-arrow-down"></i></a>
    </header>

    <div class="container" id="form-daftar">
        <div class="section-title">
            <h2>Formulir Pendaftaran</h2>
            <p>Mohon isi data di bawah ini dengan lengkap dan benar.</p>
        </div>

        <form id="pendaftaranForm">
            <input type="hidden" name="action" value="simpan_pendaftaran">

            <div class="form-grid">
                <div class="form-full"><h3 style="color:var(--primary); font-size:1.1rem;"><i class="fas fa-child"></i> Data Calon Siswa</h3></div>
                
                <div class="form-group form-full">
                    <label>Nama Lengkap Anak</label>
                    <input type="text" name="nama" required placeholder="Sesuai Akta Kelahiran">
                </div>

                <div class="form-group">
                    <label>Tempat, Tanggal Lahir</label>
                    <input type="date" name="tgl_lahir" required>
                </div>

                <div class="form-group">
                    <label>Jenis Kelamin</label>
                    <select name="jk" required>
                        <option value="">- Pilih -</option>
                        <option value="Laki-laki">Laki-laki</option>
                        <option value="Perempuan">Perempuan</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Agama</label>
                    <select name="agama" required>
                        <option value="Islam">Islam</option>
                        <option value="Kristen">Kristen</option>
                        <option value="Katolik">Katolik</option>
                        <option value="Hindu">Hindu</option>
                        <option value="Buddha">Buddha</option>
                    </select>
                </div>

                <div class="form-group form-full">
                    <label>Alamat Lengkap (Domisili)</label>
                    <textarea name="alamat" rows="2" required placeholder="Jalan, RT/RW, Kelurahan..."></textarea>
                </div>

                <div class="divider"><span>DATA ORANG TUA</span></div>

                <div class="form-group">
                    <label>Nama Ayah</label>
                    <input type="text" name="nama_ayah" required>
                </div>
                <div class="form-group">
                    <label>Pekerjaan Ayah</label>
                    <input type="text" name="pek_ayah" required>
                </div>

                <div class="form-group">
                    <label>Nama Ibu</label>
                    <input type="text" name="nama_ibu" required>
                </div>
                <div class="form-group">
                    <label>Pekerjaan Ibu</label>
                    <input type="text" name="pek_ibu" required>
                </div>

                <div class="form-group form-full">
                    <label>No. HP / WhatsApp (Ibu)</label>
                    <input type="tel" name="hp_ibu" required placeholder="Contoh: 08123456789">
                    <small style="color:grey; font-size:0.8rem;">*Nomor ini akan dihubungi untuk info wawancara</small>
                </div>

                <button type="submit" class="btn-submit">Kirim Pendaftaran <i class="fas fa-paper-plane"></i></button>
            </div>
        </form>
    </div>

    <footer>
        <p>&copy; 2024 KB Harapan Bunda. All Rights Reserved.</p>
    </footer>

    <div class="loading-overlay" id="loading">
        <div class="spinner"></div>
        <h3 style="margin-top:20px; color:var(--primary);">Mengirim Data...</h3>
        <p>Mohon jangan tutup halaman ini.</p>
    </div>

    <script>
        // URL SCRIPT GOOGLE ANDA (Sudah disesuaikan)
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxObNo1BFGjWUnRnni96YUhjOGipY1lViTfVPfyRZDbhGbuPY6nDNrX2Nu89HxqmBzRhA/exec';

        // 1. FUNGSI UNTUK MENGAMBIL DATA JUDUL WEBSITE (OPSIONAL)
        // Ini akan mencoba mengisi judul sekolah dari Admin Panel
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Gunakan Proxy untuk membaca data (Safe way for GitHub Pages)
                const target = scriptURL + '?action=get_admin_data';
                const proxyUrl = 'https://api.allorigins.win/get?url=' + encodeURIComponent(target);
                
                const response = await fetch(proxyUrl);
                const dataWrapper = await response.json();
                const data = JSON.parse(dataWrapper.contents);

                if(data.result === 'success' && data.konten) {
                    const c = data.konten;
                    if(c.judulUtama) {
                        document.getElementById('nav-title').innerText = c.judulUtama;
                        document.title = "Pendaftaran - " + c.judulUtama;
                    }
                    if(c.subJudul) document.getElementById('hero-desc').innerText = c.subJudul;
                    if(c.judulUtama) document.getElementById('hero-title').innerText = "Selamat Datang di " + c.judulUtama;
                }
            } catch (e) {
                console.log("Menggunakan konten default (Offline/Error)");
            }
        });

        // 2. FUNGSI KIRIM FORMULIR
        const form = document.getElementById('pendaftaranForm');
        const loading = document.getElementById('loading');

        form.addEventListener('submit', e => {
            e.preventDefault();
            
            // Validasi sederhana
            if(!confirm("Apakah data yang Anda isi sudah benar?")) return;

            loading.style.display = 'flex';
            
            fetch(scriptURL, { 
                method: 'POST', 
                body: new FormData(form),
                // mode 'no-cors' penting agar browser tidak memblokir request ke Google
                mode: 'no-cors'
            })
            .then(() => {
                loading.style.display = 'none';
                // Tampilkan pesan sukses cantik
                alert("Alhamdulillah, Data berhasil terkirim!\nTerima kasih Bunda sudah mendaftar.");
                form.reset();
                window.location.href = "#home"; // Kembali ke atas
            })
            .catch(error => {
                loading.style.display = 'none';
                console.error('Error!', error.message);
                alert("Maaf, terjadi gangguan koneksi. Silakan coba lagi.");
            });
        });
    </script>

</body>
</html>